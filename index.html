<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English to IPA Translator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 700px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            background-color: #f7f9fc;
            color: #333;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        .container {
            background-color: white;
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }
        .input-area {
            display: flex;
            margin-bottom: 20px;
        }
        input {
            flex: 1;
            padding: 12px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            margin-left: 10px;
            padding: 12px 20px;
            background-color: #4285f4;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.2s;
        }
        button:hover {
            background-color: #3b78e7;
        }
        .output {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            min-height: 60px;
            font-size: 18px;
            margin-bottom: 15px;
        }
        .examples button {
            background-color: #34a853;
            margin: 5px;
            font-size: 14px;
            padding: 8px 12px;
        }
        .examples button:hover {
            background-color: #2d9348;
        }
        .info {
            margin-top: 25px;
            padding: 15px;
            background-color: #e8f4fc;
            border-radius: 4px;
            font-size: 14px;
            color: #555;
        }
        .info h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .source {
            font-size: 12px;
            color: #777;
            font-style: italic;
        }
        textarea {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 4px;
            min-height: 100px;
            margin-bottom: 15px;
            resize: vertical;
        }
        .mode-selector {
            margin-bottom: 20px;
        }
        .mode-selector label {
            margin-right: 15px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>English to IPA Translator</h1>
    <div class="container">
        <div class="mode-selector">
            <input type="radio" id="word-mode" name="mode" value="word" checked>
            <label for="word-mode">Single Word</label>
            <input type="radio" id="text-mode" name="mode" value="text">
            <label for="text-mode">Full Text</label>
        </div>
        
        <div id="word-input-container" class="input-area">
            <input type="text" id="english-input" placeholder="Enter an English word" autocomplete="off">
            <button id="translate-btn">Translate</button>
        </div>
        
        <div id="text-input-container" style="display: none;">
            <textarea id="english-text-input" placeholder="Enter English text to translate to IPA"></textarea>
            <button id="translate-text-btn">Translate Text</button>
        </div>
        
        <div class="output" id="ipa-output">IPA transcription will appear here</div>
        
        <div class="examples">
            <h3>Try Example Words:</h3>
            <div>
                <button class="example-word" data-word="cat">cat</button>
                <button class="example-word" data-word="dog">dog</button>
                <button class="example-word" data-word="better">better</button>
                <button class="example-word" data-word="mirror">mirror</button>
                <button class="example-word" data-word="computer">computer</button>
                <button class="example-word" data-word="pronunciation">pronunciation</button>
                <button class="example-word" data-word="veterinary">veterinary</button>
                <button class="example-word" data-word="territory">territory</button>
                <button class="example-word" data-word="superb">superb</button>
                <button class="example-word" data-word="hurry">hurry</button>
                <button class="example-word" data-text="Well, here's a story for you: Sarah Perry was a veterinary nurse.">Sample Text</button>
            </div>
        </div>
        
        <div class="info">
            <h3>About This Translator</h3>
            <p>This translator converts English words to their IPA (International Phonetic Alphabet) pronunciation using General American English dialect rules. It handles r-colored vowels, flapped t's, stress patterns, and other phonological features of American English.</p>
            
            <h3>Common IPA Symbols for American English</h3>
            <table>
                <tr>
                    <th>IPA Symbol</th>
                    <th>Example</th>
                    <th>IPA Symbol</th>
                    <th>Example</th>
                </tr>
                <tr>
                    <td>æ</td>
                    <td>cat, bad</td>
                    <td>ʃ</td>
                    <td>she, nation</td>
                </tr>
                <tr>
                    <td>ɑː</td>
                    <td>father, spa</td>
                    <td>ʒ</td>
                    <td>vision, pleasure</td>
                </tr>
                <tr>
                    <td>ɛ</td>
                    <td>bed, feather</td>
                    <td>tʃ</td>
                    <td>chair, nature</td>
                </tr>
                <tr>
                    <td>iː</td>
                    <td>see, meat</td>
                    <td>dʒ</td>
                    <td>just, edge</td>
                </tr>
                <tr>
                    <td>ɪ</td>
                    <td>sit, women</td>
                    <td>ŋ</td>
                    <td>sing, think</td>
                </tr>
                <tr>
                    <td>ɔː</td>
                    <td>law, caught</td>
                    <td>θ</td>
                    <td>thin, through</td>
                </tr>
                <tr>
                    <td>ʌ</td>
                    <td>cup, love</td>
                    <td>ð</td>
                    <td>this, father</td>
                </tr>
                <tr>
                    <td>uː</td>
                    <td>tool, blue</td>
                    <td>ə</td>
                    <td>about, supply</td>
                </tr>
                <tr>
                    <td>ʊ</td>
                    <td>book, should</td>
                    <td>ɚ</td>
                    <td>butter, worker</td>
                </tr>
                <tr>
                    <td>eɪ</td>
                    <td>day, pain</td>
                    <td>ɝ</td>
                    <td>bird, fur</td>
                </tr>
                <tr>
                    <td>aɪ</td>
                    <td>my, sight</td>
                    <td>ɾ</td>
                    <td>better, water</td>
                </tr>
                <tr>
                    <td>oʊ</td>
                    <td>go, boat</td>
                    <td>ɻ</td>
                    <td>run, right</td>
                </tr>
                <tr>
                    <td>aʊ</td>
                    <td>now, house</td>
                    <td>ˈ</td>
                    <td>primary stress</td>
                </tr>
                <tr>
                    <td>ɔɪ</td>
                    <td>boy, choice</td>
                    <td>ˌ</td>
                    <td>secondary stress</td>
                </tr>
            </table>
        </div>
    </div>

    <script>
        // American English IPA Dictionary - Core words and examples
        const ipaDict = {
            // Basic function words
            "a": "ə",
            "an": "ən",
            "the": "ðə",
            "of": "əv",
            "to": "tu",
            "and": "ænd",
            "in": "ɪn",
            "is": "ɪz",
            "it": "ɪt",
            "for": "fɔɹ",
            "you": "ju",
            "that": "ðæt",
            "he": "hi",
            "was": "wəz",
            "on": "ɑn",
            "are": "ɑɹ",
            "with": "wɪð",
            "as": "æz",
            "his": "hɪz",
            "they": "ðeɪ",
            "be": "bi",
            "at": "æt",
            "one": "wʌn",
            "have": "hæv",
            "this": "ðɪs",
            "from": "fɹʌm",
            "or": "ɔɹ",
            "had": "hæd",
            "by": "baɪ",
            "not": "nɑt",
            "word": "wɝd",
            "but": "bʌt",
            "what": "wʌt",
            "all": "ɔl",
            "were": "wɝ",
            "we": "wi",
            "when": "wɛn",
            "your": "jʊɹ",
            "can": "kæn",
            "said": "sɛd",
            "there": "ðɛɹ",
            "use": "juz",
            
            // Words from "Comma Gets a Cure" passage
            "well": "wɛl",
            "here's": "hɪɹz",
            "story": "stɔɹi",
            "sarah": "sɛɹə",
            "perry": "pɛɹi",
            "veterinary": "ˈvɛtəɹɪnɛɹi",
            "nurse": "nɝs",
            "who": "hu",
            "been": "bɪn",
            "working": "ˈwɝkɪŋ",
            "daily": "ˈdeɪli",
            "at": "æt",
            "old": "oʊld",
            "zoo": "zu",
            "deserted": "dɪˈzɝtəd",
            "district": "ˈdɪstɹɪkt",
            "territory": "ˈtɛɹətɔɹi",
            "so": "soʊ",
            "she": "ʃi",
            "very": "ˈvɛɹi",
            "happy": "ˈhæpi",
            "start": "stɑɹt",
            "new": "nu",
            "job": "dʒɑb",
            "superb": "suˈpɝb",
            "private": "ˈpɹaɪvət",
            "practice": "ˈpɹæktɪs",
            "north": "nɔɹθ",
            "square": "skwɛɹ",
            "near": "nɪɹ",
            "duke": "duk",
            "street": "stɹit",
            "tower": "ˈtaʊɚ",
            "that": "ðæt",
            "area": "ˈɛɹiə",
            "much": "mʌtʃ",
            "nearer": "ˈnɪɹɚ",
            "her": "hɝ",
            "and": "ænd",
            "more": "mɔɹ",
            "liking": "ˈlaɪkɪŋ",
            "even": "ˈivən",
            "on": "ɑn",
            "first": "fɝst",
            "morning": "ˈmɔɹnɪŋ",
            "felt": "fɛlt",
            "stressed": "stɹɛst",
            "ate": "eɪt",
            "bowl": "boʊl",
            "porridge": "ˈpɔɹɪdʒ",
            "checked": "tʃɛkt",
            "herself": "hɝˈsɛlf",
            "mirror": "ˈmɪɹɚ",
            "washed": "wɑʃt",
            "face": "feɪs",
            "hurry": "ˈhɝi",
            "then": "ðɛn",
            "put": "pʊt",
            "plain": "pleɪn",
            "yellow": "ˈjɛloʊ",
            "dress": "dɹɛs",
            "fleece": "flis",
            "jacket": "ˈdʒækət",
            "picked": "pɪkt",
            "up": "ʌp",
            "kit": "kɪt",
            "headed": "ˈhɛdəd",
            "work": "wɝk",
            
            // Common words with special pronunciations
            "cat": "kæt",
            "dog": "dɔg",
            "mouse": "maʊs",
            "computer": "kəmˈpjutɚ",
            "america": "əˈmɛɹɪkə",
            "water": "ˈwɔɾɚ",
            "better": "ˈbɛɾɚ",
            "butter": "ˈbʌɾɚ",
            "happy": "ˈhæpi",
            "running": "ˈɹʌnɪŋ",
            "phone": "foʊn",
            "through": "θɹu",
            "thought": "θɔt",
            "bird": "bɝd",
            "word": "wɝd",
            "world": "wɝld",
            "learn": "lɝn",
            "correct": "kəˈɹɛkt",
            "terrible": "ˈtɛɹəbəl",
            "horror": "ˈhɔɹɚ",
            "mirror": "ˈmɪɹɚ",
            "apple": "ˈæpəl",
            "banana": "bəˈnænə",
            "orange": "ˈɔɹɪndʒ",
            "algorithm": "ˈælgəˌɹɪðəm",
            "pronunciation": "pɹəˌnʌnsiˈeɪʃən",
            "elephant": "ˈɛləfənt",
            "beautiful": "ˈbjuɾəfəl",
            "dictionary": "ˈdɪkʃəˌnɛɹi",
            "everything": "ˈɛvɹiˌθɪŋ",
            "knowledge": "ˈnɑlɪdʒ",
            "language": "ˈlæŋgwɪdʒ",
            "mountain": "ˈmaʊntən",
            "question": "ˈkwɛstʃən",
            "remember": "ɹɪˈmɛmbɚ",
            "technology": "tɛkˈnɑlədʒi",
            "university": "ˌjunəˈvɝsəti",
            "vegetable": "ˈvɛdʒtəbəl",
            "yesterday": "ˈjɛstɚdeɪ",
            "english": "ˈɪŋglɪʃ",
            "american": "əˈmɛɹɪkən"
        };

        // Common word patterns for American English phonology
        const wordPatterns = [
            // Vowel sounds (with length marking for stressed vowels)
            { pattern: /a(?=r[^aeiou]|r$)/, phonology: "ɑɹ" },    // car, far
            { pattern: /a(?=[^aeiou]e$)/, phonology: "eɪ" },      // bake, late
            { pattern: /a(?=w|ll|lk|lt)/, phonology: "ɔ" },       // law, tall, walk
            { pattern: /ee|ea/, phonology: "i" },                 // see, meat
            { pattern: /e(?=r[^aeiou]|r$)/, phonology: "ɝ" },     // her, verb
            { pattern: /i(?=r[^aeiou]|r$)/, phonology: "ɝ" },     // bird, stir
            { pattern: /u(?=r[^aeiou]|r$)/, phonology: "ɝ" },     // burn, hurt
            { pattern: /o(?=r[^aeiou]|r$)/, phonology: "ɔɹ" },    // for, north
            { pattern: /i(?=[^aeiou]e$)/, phonology: "aɪ" },      // time, like
            { pattern: /o(?=[^aeiou]e$)/, phonology: "oʊ" },      // home, joke
            { pattern: /u(?=[^aeiou]e$)/, phonology: "ju" },      // use, cute
            { pattern: /oo/, phonology: "u" },                    // moon, food
            { pattern: /oo(?=k|d)/, phonology: "ʊ" },             // book, good
            { pattern: /ou|ow/, phonology: "aʊ" },                // out, how
            { pattern: /oi|oy/, phonology: "ɔɪ" },                // boy, noise
            { pattern: /ai|ay/, phonology: "eɪ" },                // day, wait
            
            // Consonant patterns
            { pattern: /t(?=[aeiou][aeiou]|[aeiou]n|[aeiou]r|[aeiou]l)/, phonology: "ɾ" },  // better, water, party
            { pattern: /tt(?=[aeiou])/, phonology: "ɾ" },         // butter, better
            { pattern: /d(?=[aeiou][aeiou]|[aeiou]n|[aeiou]r|[aeiou]l)/, phonology: "ɾ" },  // medal, ladder
            { pattern: /dd(?=[aeiou])/, phonology: "ɾ" },         // ladder, muddy
            { pattern: /th(?=[aeiouwy])/, phonology: "θ" },       // thin, through (voiceless)
            { pattern: /th(?=[aeiou][^aeiou])/, phonology: "ð" }, // this, that (voiced)
            { pattern: /sh|ti(?=on)|ci(?=a)/, phonology: "ʃ" },   // ship, nation, special
            { pattern: /si(?=on)|[sz](?=ure)/, phonology: "ʒ" },  // vision, measure
            { pattern: /ch|tch/, phonology: "tʃ" },               // chair, watch
            { pattern: /j|dge|g(?=i|e|y)/, phonology: "dʒ" },     // join, judge, gem
            { pattern: /ng/, phonology: "ŋ" },                    // sing, thing
            { pattern: /ph/, phonology: "f" },                    // phone, graph
            { pattern: /gh(?=t)/, phonology: "t" },              // night, light (silent)
            { pattern: /gh$/, phonology: "" },                    // though (silent)
            { pattern: /kn|gn/, phonology: "n" },                 // know, gnome
            { pattern: /wh/, phonology: "w" },                    // what, where
            { pattern: /wr/, phonology: "ɹ" },                    // write, wrong
            { pattern: /mb$/, phonology: "m" },                   // climb, bomb
            { pattern: /w(?=[aeiou])/, phonology: "w" },          // west, away
            { pattern: /y(?=[aeiou])/, phonology: "j" },          // yes, beyond
            
            // Common suffixes
            { pattern: /tion$/, phonology: "ʃən" },               // nation, station
            { pattern: /sion$/, phonology: "ʒən" },               // vision, precision
            { pattern: /cian$/, phonology: "ʃən" },               // musician, physician
            { pattern: /tial$/, phonology: "ʃəl" },               // partial, essential
            { pattern: /cial$/, phonology: "ʃəl" },               // social, special
            { pattern: /ing$/, phonology: "ɪŋ" },                 // running, walking
            { pattern: /ed$/, phonology: "d" },                   // played, stayed (after voiced sounds)
            { pattern: /ed$/, phonology: "t" },                   // walked, talked (after voiceless sounds)
            { pattern: /ed$/, phonology: "əd" },                  // needed, wanted (after t or d)
            { pattern: /er$|or$/, phonology: "ɚ" },               // faster, doctor
            { pattern: /ar$/, phonology: "ɚ" },                   // dollar, sugar
            { pattern: /le$/, phonology: "əl" },                  // simple, little
            { pattern: /ful$/, phonology: "fəl" },                // careful, beautiful
            { pattern: /ment$/, phonology: "mənt" },              // argument, government
            { pattern: /ness$/, phonology: "nəs" },               // kindness, happiness
            { pattern: /age$/, phonology: "ɪdʒ" },                // village, manage
            { pattern: /ate$/, phonology: "eɪt" },                // create, celebrate
            
            // Common prefixes
            { pattern: /^un/, phonology: "ʌn" },                  // unpopular, unhappy
            { pattern: /^re/, phonology: "ɹi" },                  // rewrite, relearn
            { pattern: /^pre/, phonology: "pɹi" },                // prepare, preview
            { pattern: /^in/, phonology: "ɪn" },                  // inside, incorrect
            { pattern: /^im/, phonology: "ɪm" },                  // impossible, impolite
            { pattern: /^dis/, phonology: "dɪs" },                // discover, display
            { pattern: /^con/, phonology: "kɑn" },                // contact, control
            { pattern: /^com/, phonology: "kɑm" },                // combine, compare
            { pattern: /^pro/, phonology: "pɹoʊ" },               // produce, progress
            { pattern: /^ex/, phonology: "ɛks" },                 // explain, example
            
            // Double consonants (treated as single in pronunciation)
            { pattern: /mm/, phonology: "m" },
            { pattern: /nn/, phonology: "n" },
            { pattern: /pp/, phonology: "p" },
            { pattern: /bb/, phonology: "b" },
            { pattern: /ff/, phonology: "f" },
            { pattern: /gg/, phonology: "g" },
            { pattern: /ll/, phonology: "l" },
            { pattern: /rr/, phonology: "ɹ" },
            { pattern: /ss/, phonology: "s" },
            { pattern: /zz/, phonology: "z" }
        ];

        // Special r-colored vowel contexts
        const rColoredVowels = [
            { pattern: /ar(?=[bdfjklmnpstvz]|$)/, replacement: "ɑɹ" },  // car, far, star
            { pattern: /er(?=[bdfjklmnpstvz]|$)/, replacement: "ɝ" },   // her, person, serve
            { pattern: /ir(?=[bdfjklmnpstvz]|$)/, replacement: "ɝ" },   // bird, third, stir
            { pattern: /or(?=[bdfjklmnpstvz]|$)/, replacement: "ɔɹ" },  // for, more, store
            { pattern: /ur(?=[bdfjklmnpstvz]|$)/, replacement: "ɝ" },   // turn, burn, fur
            { pattern: /ear(?=[bdfjklmnpstvz]|$)/, replacement: "ɪɹ" }, // fear, near, year
            { pattern: /eer(?=[bdfjklmnpstvz]|$)/, replacement: "ɪɹ" }, // peer, deer, cheer
            { pattern: /air(?=[bdfjklmnpstvz]|$)/, replacement: "ɛɹ" }, // fair, hair, chair
            { pattern: /are(?=$)/, replacement: "ɛɹ" },                // care, bare, share
            { pattern: /oor(?=[bdfjklmnpstvz]|$)/, replacement: "ɔɹ" }, // door, floor
            { pattern: /our(?=[bdfjklmnpstvz]|$)/, replacement: "ɔɹ" }  // pour, four
        ];

        // Flap rules for t/tt/d/dd between vowels in unstressed positions
        const flapRules = [
            { pattern: /t(?=[aeiou][bcdfghjklmnpqrstvwxyz]?)/, replacement: "ɾ" },  // better, water, city
            { pattern: /tt(?=[aeiou][bcdfghjklmnpqrstvwxyz]?)/, replacement: "ɾ" }, // butter, mattress
            { pattern: /d(?=[aeiou][bcdfghjklmnpqrstvwxyz]?)/, replacement: "ɾ" },  // ladder, body
            { pattern: /dd(?=[aeiou][bcdfghjklmnpqrstvwxyz]?)/, replacement: "ɾ" }  // buddy, ladder
        ];

        // Function to translate English word to IPA
        function translateToIPA(word) {
            word = word.toLowerCase().trim();
            
            if (!word) {
                return "Please enter a word";
            }
            
            // Check if word is in dictionary
            if (ipaDict[word]) {
                return ipaDict[word] + " <span class='source'>(from dictionary)</span>";
            } 
            
            // Try to find close matches in dictionary for better results
            const similarWords = findSimilarWords(word, ipaDict);
            if (similarWords.length > 0) {
                // For names and common words, use closest match if very similar
                const bestMatch = similarWords[0];
                if (bestMatch.similarity > 0.85) {
                    return ipaDict[bestMatch.word] + 
                           " <span class='source'>(from similar word: " + bestMatch.word + ")</span>";
                }
            }
            
            // If not in dictionary, use rule-based approximation
            try {
                const approximation = algorithmicTranslate(word);
                return approximation + " <span class='source'>(approximated)</span>";
            } catch (error) {
                console.error("Error in translation:", error);
                return "Could not translate: " + error.message;
            }
        }
        
        // Function to translate a full English text to IPA
        function translateTextToIPA(text) {
            if (!text.trim()) {
                return "Please enter text to translate";
            }
            
            // Split text into words and punctuation
            const words = text.match(/\b[\w']+\b|[.,!?;:]/g) || [];
            
            let ipaText = "";
            let currentIndex = 0;
            
            // Process each word
            for (const word of words) {
                // Skip punctuation
                if (/^[.,!?;:]$/.test(word)) {
                    ipaText += word + " ";
                    continue;
                }
                
                // Translate the word
                let ipaWord = "";
                
                // Check if word is in dictionary
                if (ipaDict[word.toLowerCase()]) {
                    ipaWord = ipaDict[word.toLowerCase()];
                } else {
                    // Try algorithmic translation
                    try {
                        ipaWord = algorithmicTranslate(word.toLowerCase());
                    } catch (error) {
                        console.error