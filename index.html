<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English to IPA Translator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 700px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            background-color: #f7f9fc;
            color: #333;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        .container {
            background-color: white;
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }
        .input-area {
            display: flex;
            margin-bottom: 20px;
        }
        input {
            flex: 1;
            padding: 12px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            margin-left: 10px;
            padding: 12px 20px;
            background-color: #4285f4;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.2s;
        }
        button:hover {
            background-color: #3b78e7;
        }
        .output {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            min-height: 60px;
            font-size: 18px;
            margin-bottom: 15px;
        }
        .examples button {
            background-color: #34a853;
            margin: 5px;
            font-size: 14px;
            padding: 8px 12px;
        }
        .examples button:hover {
            background-color: #2d9348;
        }
        .info {
            margin-top: 25px;
            padding: 15px;
            background-color: #e8f4fc;
            border-radius: 4px;
            font-size: 14px;
            color: #555;
        }
        .info h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .source {
            font-size: 12px;
            color: #777;
            font-style: italic;
        }
        textarea {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 4px;
            min-height: 100px;
            margin-bottom: 15px;
            resize: vertical;
        }
        .mode-selector {
            margin-bottom: 20px;
        }
        .mode-selector label {
            margin-right: 15px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>English to IPA Translator</h1>
    <div class="container">
        <div class="mode-selector">
            <input type="radio" id="word-mode" name="mode" value="word" checked>
            <label for="word-mode">Single Word</label>
            <input type="radio" id="text-mode" name="mode" value="text">
            <label for="text-mode">Full Text</label>
        </div>
        
        <div id="word-input-container" class="input-area">
            <input type="text" id="english-input" placeholder="Enter an English word" autocomplete="off">
            <button id="translate-btn">Translate</button>
        </div>
        
        <div id="text-input-container" style="display: none;">
            <textarea id="english-text-input" placeholder="Enter English text to translate to IPA"></textarea>
            <button id="translate-text-btn">Translate Text</button>
        </div>
        
        <div class="output" id="ipa-output">IPA transcription will appear here</div>
        
        <div class="examples">
            <h3>Try Example Words:</h3>
            <div>
                <button class="example-word" data-word="cat">cat</button>
                <button class="example-word" data-word="dog">dog</button>
                <button class="example-word" data-word="better">better</button>
                <button class="example-word" data-word="mirror">mirror</button>
                <button class="example-word" data-word="computer">computer</button>
                <button class="example-word" data-word="pronunciation">pronunciation</button>
                <button class="example-word" data-word="veterinary">veterinary</button>
                <button class="example-word" data-word="territory">territory</button>
                <button class="example-word" data-word="superb">superb</button>
                <button class="example-word" data-word="hurry">hurry</button>
                <button class="example-text">Sample Text</button>
            </div>
        </div>
        
        <div class="info">
            <h3>About This Translator</h3>
            <p>This translator converts English words to their IPA (International Phonetic Alphabet) pronunciation using General American English dialect rules. It handles r-colored vowels, flapped t's, stress patterns, and other phonological features of American English.</p>
            
            <h3>Common IPA Symbols for American English</h3>
            <table>
                <tr>
                    <th>IPA Symbol</th>
                    <th>Example</th>
                    <th>IPA Symbol</th>
                    <th>Example</th>
                </tr>
                <tr>
                    <td>æ</td>
                    <td>cat, bad</td>
                    <td>ʃ</td>
                    <td>she, nation</td>
                </tr>
                <tr>
                    <td>ɑː</td>
                    <td>father, spa</td>
                    <td>ʒ</td>
                    <td>vision, pleasure</td>
                </tr>
                <tr>
                    <td>ɛ</td>
                    <td>bed, feather</td>
                    <td>tʃ</td>
                    <td>chair, nature</td>
                </tr>
                <tr>
                    <td>iː</td>
                    <td>see, meat</td>
                    <td>dʒ</td>
                    <td>just, edge</td>
                </tr>
                <tr>
                    <td>ɪ</td>
                    <td>sit, women</td>
                    <td>ŋ</td>
                    <td>sing, think</td>
                </tr>
                <tr>
                    <td>ɔː</td>
                    <td>law, caught</td>
                    <td>θ</td>
                    <td>thin, through</td>
                </tr>
                <tr>
                    <td>ʌ</td>
                    <td>cup, love</td>
                    <td>ð</td>
                    <td>this, father</td>
                </tr>
                <tr>
                    <td>uː</td>
                    <td>tool, blue</td>
                    <td>ə</td>
                    <td>about, supply</td>
                </tr>
                <tr>
                    <td>ʊ</td>
                    <td>book, should</td>
                    <td>ɚ</td>
                    <td>butter, worker</td>
                </tr>
                <tr>
                    <td>eɪ</td>
                    <td>day, pain</td>
                    <td>ɝ</td>
                    <td>bird, fur</td>
                </tr>
                <tr>
                    <td>aɪ</td>
                    <td>my, sight</td>
                    <td>ɾ</td>
                    <td>better, water</td>
                </tr>
                <tr>
                    <td>oʊ</td>
                    <td>go, boat</td>
                    <td>ɹ</td>
                    <td>run, right</td>
                </tr>
                <tr>
                    <td>aʊ</td>
                    <td>now, house</td>
                    <td>ˈ</td>
                    <td>primary stress</td>
                </tr>
                <tr>
                    <td>ɔɪ</td>
                    <td>boy, choice</td>
                    <td>ˌ</td>
                    <td>secondary stress</td>
                </tr>
            </table>
        </div>
    </div>

    <script>
        // Dictionary of common words with their IPA transcriptions
        const ipaDict = {
            // Words from "Comma Gets a Cure" passage
            "well": "wɛl",
            "here's": "hɪɹz",
            "a": "ə",
            "story": "ˈstɔɹi",
            "for": "fɔɹ",
            "you": "ju",
            "sarah": "ˈsɛɹə",
            "perry": "ˈpɛɹi",
            "was": "wəz",
            "veterinary": "ˈvɛtəɹɪnɛɹi",
            "nurse": "nɝs",
            "who": "hu",
            "had": "hæd",
            "been": "bɪn",
            "working": "ˈwɝkɪŋ",
            "daily": "ˈdeɪli",
            "at": "æt",
            "an": "æn",
            "old": "oʊld",
            "zoo": "zu",
            "in": "ɪn",
            "deserted": "dɪˈzɝtəd",
            "district": "ˈdɪstɹɪkt",
            "of": "əv",
            "the": "ðə",
            "territory": "ˈtɛɹətɔɹi",
            "so": "soʊ",
            "she": "ʃi",
            "very": "ˈvɛɹi",
            "happy": "ˈhæpi",
            "to": "tu",
            "start": "stɑɹt",
            "new": "nu",
            "job": "dʒɑb",
            "superb": "suˈpɝb",
            "private": "ˈpɹaɪvət",
            "practice": "ˈpɹæktɪs",
            "north": "nɔɹθ",
            "square": "skwɛɹ",
            "near": "nɪɹ",
            "duke": "duk",
            "street": "stɹit",
            "tower": "ˈtaʊɚ",
            "that": "ðæt",
            "area": "ˈɛɹiə",
            "much": "mʌtʃ",
            "nearer": "ˈnɪɹɚ",
            "her": "hɝ",
            "and": "ænd",
            "more": "mɔɹ",
            "liking": "ˈlaɪkɪŋ",
            "even": "ˈivən",
            "on": "ɑn",
            "first": "fɝst",
            "morning": "ˈmɔɹnɪŋ",
            "felt": "fɛlt",
            "stressed": "stɹɛst",
            "ate": "eɪt",
            "bowl": "boʊl",
            "porridge": "ˈpɔɹɪdʒ",
            "checked": "tʃɛkt",
            "herself": "hɝˈsɛlf",
            "mirror": "ˈmɪɹɚ",
            "washed": "wɑʃt",
            "face": "feɪs",
            "hurry": "ˈhɝi",
            "then": "ðɛn",
            "put": "pʊt",
            "plain": "pleɪn",
            "yellow": "ˈjɛloʊ",
            "dress": "dɹɛs",
            "fleece": "flis",
            "jacket": "ˈdʒækət",
            "picked": "pɪkt",
            "up": "ʌp",
            "kit": "kɪt",
            "headed": "ˈhɛdəd",
            "work": "wɝk",

            // Common words with special pronunciations
            "cat": "kæt",
            "dog": "dɔg",
            "mouse": "maʊs",
            "computer": "kəmˈpjutɚ",
            "america": "əˈmɛɹɪkə",
            "water": "ˈwɔɾɚ",
            "better": "ˈbɛɾɚ",
            "butter": "ˈbʌɾɚ",
            "happy": "ˈhæpi",
            "running": "ˈɹʌnɪŋ",
            "phone": "foʊn",
            "through": "θɹu",
            "thought": "θɔt",
            "bird": "bɝd",
            "word": "wɝd",
            "world": "wɝld",
            "learn": "lɝn",
            "correct": "kəˈɹɛkt",
            "terrible": "ˈtɛɹəbəl",
            "horror": "ˈhɔɹɚ",
            "mirror": "ˈmɪɹɚ",
            "apple": "ˈæpəl",
            "banana": "bəˈnænə",
            "orange": "ˈɔɹɪndʒ",
            "algorithm": "ˈælgəˌɹɪðəm",
            "pronunciation": "pɹəˌnʌnsiˈeɪʃən",
            "elephant": "ˈɛləfənt",
            "beautiful": "ˈbjuɾəfəl",
            "dictionary": "ˈdɪkʃəˌnɛɹi",
            "everything": "ˈɛvɹiˌθɪŋ",
            "knowledge": "ˈnɑlɪdʒ",
            "language": "ˈlæŋgwɪdʒ",
            "mountain": "ˈmaʊntən",
            "question": "ˈkwɛstʃən",
            "remember": "ɹɪˈmɛmbɚ",
            "technology": "tɛkˈnɑlədʒi",
            "university": "ˌjunəˈvɝsəti",
            "vegetable": "ˈvɛdʒtəbəl",
            "yesterday": "ˈjɛstɚdeɪ",
            "english": "ˈɪŋglɪʃ",
            "american": "əˈmɛɹɪkən"
        };

        // Sample text translation
        const sampleText = "Well, here's a story for you: Sarah Perry was a veterinary nurse who had been working daily at an old zoo in a deserted district of the territory.";
        
        // Function to translate a single word to IPA
        function translateWord(word) {
            // Convert to lowercase and trim whitespace
            const cleanWord = word.toLowerCase().trim();
            
            // Return empty string for empty input
            if (!cleanWord) return "";
            
            // Check if the word is in our dictionary
            if (ipaDict[cleanWord]) {
                return ipaDict[cleanWord];
            }
            
            // For words not in the dictionary, apply phonological rules
            return applyPhonologicalRules(cleanWord);
        }
        
        // Function to apply phonological rules for American English
        function applyPhonologicalRules(word) {
            // Apply specific patterns for American English
            let result = word.toLowerCase();

            // Handle r-colored vowels (very important in American English)
            result = result
                .replace(/ar(?=[^aeiou]|$)/, "ɑɹ")  // car, far
                .replace(/er(?=[^aeiou]|$)/, "ɝ")   // her, server
                .replace(/ir(?=[^aeiou]|$)/, "ɝ")   // bird, first
                .replace(/or(?=[^aeiou]|$)/, "ɔɹ")  // for, more
                .replace(/ur(?=[^aeiou]|$)/, "ɝ")   // turn, burn
                .replace(/ear(?=[^aeiou]|$)/, "ɪɹ") // fear, near
                .replace(/air(?=[^aeiou]|$)/, "ɛɹ") // fair, chair
                .replace(/oor(?=[^aeiou]|$)/, "ɔɹ") // door, floor
                .replace(/r(?=[aeiou])/, "ɹ");      // American rhotic 'r'

            // Handle flapped t/d between vowels (characteristic of American English)
            result = result
                .replace(/t(?=[aeiou][^aeiou]|[aeiou]$)/, "ɾ")  // better, water
                .replace(/tt(?=[aeiou])/, "ɾ")                 // butter, bitter
                .replace(/d(?=[aeiou][^aeiou]|[aeiou]$)/, "ɾ")  // rider, muddy
                .replace(/dd(?=[aeiou])/, "ɾ");                // ladder, buddy

            // Handle common vowel patterns
            result = result
                .replace(/a(?=[^aeiou]e$)/, "eɪ")      // bake, rake
                .replace(/e(?=[^aeiou]e$)/, "i")        // complete, these
                .replace(/i(?=[^aeiou]e$)/, "aɪ")       // bike, like
                .replace(/o(?=[^aeiou]e$)/, "oʊ")       // home, rope
                .replace(/u(?=[^aeiou]e$)/, "ju")       // cute, mute
                .replace(/oo/, "u")                      // food, mood
                .replace(/oo(?=k|d)/, "ʊ")              // book, good
                .replace(/ee|ea/, "i")                   // seem, mean
                .replace(/ou|ow/, "aʊ")                  // house, now
                .replace(/oi|oy/, "ɔɪ")                  // boy, noise
                .replace(/ai|ay/, "eɪ")                  // day, rain
                .replace(/a(?=[^aeiou][^e]|$)/, "æ")     // cat, bad
                .replace(/e(?=[^aeiou][^e]|$)/, "ɛ")     // bed, met
                .replace(/i(?=[^aeiou][^e]|$)/, "ɪ")     // bit, hit
                .replace(/o(?=[^aeiou][^e]|$)/, "ɑ")     // hot, not (American)
                .replace(/u(?=[^aeiou][^e]|$)/, "ʌ");    // but, cut

            // Handle common consonant patterns
            result = result
                .replace(/th(?=[aeiou])/, "θ")           // think, through
                .replace(/th(?=[bcdfghjklmnpqrstvwxz])/, "θ") // health, wealth
                .replace(/th/, "ð")                       // this, that
                .replace(/sh|ti(?=on)|ci(?=a)/, "ʃ")      // ship, nation, special
                .replace(/si(?=on)|[sz](?=ure)/, "ʒ")     // vision, pleasure
                .replace(/ch|tch/, "tʃ")                  // chair, match
                .replace(/j|dge|g(?=i|e|y)/, "dʒ")        // jam, edge, gym
                .replace(/ng/, "ŋ")                       // sing, thing
                .replace(/ph/, "f")                       // phone, graph
                .replace(/kn|gn/, "n")                    // know, gnome
                .replace(/wh/, "w")                       // what, where
                .replace(/wr/, "ɹ")                       // write, wrong
                .replace(/c(?=[eiy])/, "s")               // city, cent
                .replace(/c/, "k")                        // cat, cut
                .replace(/ck/, "k")                       // back, pick
                .replace(/x/, "ks")                       // box, six
                .replace(/qu/, "kw")                      // queen, quick
                .replace(/r/g, "ɹ");                      // always use American rhotic

            // Handle schwa in unstressed syllables
            if (result.length > 3) {
                // Convert unstressed vowels to schwa
                result = result.replace(/[aeiou](?=[bcdfghjklmnpqrstvwxyz]{1,2}[aeiou])/g, "ə");
            }

            // Add stress markers for words with multiple syllables
            const syllableCount = countSyllables(result);
            if (syllableCount > 1) {
                result = addStressMarker(result);
            }

            return result;
        }
        
        // Count syllables in a word
        function countSyllables(word) {
            // Count vowel sequences as an approximation of syllables
            const matches = word.match(/[aeiouyæɑɛɪɔʌʊəɚɝiuoʊeɪaɪɔɪaʊ]+/g) || [];
            return matches.length;
        }
        
        // Add primary stress marker to a word
        function addStressMarker(word) {
            // Simple approach: add primary stress to first syllable
            // This is a simplification - real English stress is more complex
            const vowelMatch = word.match(/[aeiouyæɑɛɪɔʌʊəɚɝiuoʊeɪaɪɔɪaʊ]+/);
            if (vowelMatch) {
                const index = vowelMatch.index;
                return word.slice(0, index) + 'ˈ' + word.slice(index);
            }
            return word;
        }
        
        // Function to translate full text to IPA
        function translateText(text) {
            if (!text.trim()) return "";
            
            // Split text into words, preserving punctuation
            const tokens = text.match(/\b[\w']+\b|[.,!?;:]/g) || [];
            
            // Translate each word
            const translatedTokens = tokens.map(token => {
                // Skip punctuation
                if (/^[.,!?;:]$/.test(token)) {
                    return token;
                }
                return translateWord(token);
            });
            
            // Join with spaces
            return translatedTokens.join(' ');
        }
        
        // Initialize the application once the DOM is loaded
        window.onload = function() {
            console.log("Window loaded, initializing application...");
            
            // Get references to DOM elements
            const translateBtn = document.getElementById('translate-btn');
            const translateTextBtn = document.getElementById('translate-text-btn');
            const englishInput = document.getElementById('english-input');
            const englishTextInput = document.getElementById('english-text-input');
            const ipaOutput = document.getElementById('ipa-output');
            const wordMode = document.getElementById('word-mode');
            const textMode = document.getElementById('text-mode');
            const wordInputContainer = document.getElementById('word-input-container');
            const textInputContainer = document.getElementById('text-input-container');
            
            // Handle mode switching
            wordMode.onclick = function() {
                wordInputContainer.style.display = 'flex';
                textInputContainer.style.display = 'none';
            };
            
            textMode.onclick = function() {
                wordInputContainer.style.display = 'none';
                textInputContainer.style.display = 'block';
            };
            
            // Set up click handler for translate button
            translateBtn.onclick = function() {
                const word = englishInput.value.trim();
                if (!word) {
                    ipaOutput.textContent = "Please enter a word";
                    return;
                }
                
                try {
                    const translation = translateWord(word);
                    ipaOutput.textContent = translation;
                } catch (error) {
                    console.error("Translation error:", error);
                    ipaOutput.textContent = "Error translating: " + error.message;
                }
            };
            
            // Set up click handler for translate text button
            translateTextBtn.onclick = function() {
                const text = englishTextInput.value.trim();
                if (!text) {
                    ipaOutput.textContent = "Please enter text";
                    return;
                }
                
                try {
                    const translation = translateText(text);
                    ipaOutput.textContent = translation;
                } catch (error) {
                    console.error("Translation error:", error);
                    ipaOutput.textContent = "Error translating: " + error.message;
                }
            };
            
            // Set up enter key handler for word input
            englishInput.onkeypress = function(e) {
                if (e.key === 'Enter') {
                    translateBtn.onclick();
                }
            };
            
            // Set up example word buttons
            const exampleWordButtons = document.querySelectorAll('.example-word');
            exampleWordButtons.forEach(button => {
                button.onclick = function() {
                    const word = this.getAttribute('data-word');
                    englishInput.value = word;
                    wordMode.checked = true;
                    wordInputContainer.style.display = 'flex';
                    textInputContainer.style.display = 'none';
                    translateBtn.onclick();
                };
            });
            
            // Set up sample text button
            const sampleTextButton = document.querySelector('.example-text');
            sampleTextButton.onclick = function() {
                englishTextInput.value = sampleText;
                textMode.checked = true;
                wordInputContainer.style.display = 'none';
                textInputContainer.style.display = 'block';
                translateTextBtn.onclick();
            };
            
            console.log("Application initialized successfully");
        };
    </script>
</body>
</html>